# Описание модуля HC-11
# Андрей Валиков.


## Общие сведения
* HC-11 - беспроводной модуль, работающий на частоте 434 МГц.
* Пользователю не нужно программировать модуль, только четыре режима отвечают за прием и отправку данных последовательного порта.
* Низкое потребление тока: `80мкA`, `3.5мA`, `22мA`, в зависимости от выбранного режима.
* Неограниченное число байтов, передаваемое одновременно (но часть может быть потеряна).
* Все параметры сохраняются в памяти даже в случае отключения питания.
* Рабочее напряжение: `3.3 - 5В`

## Режимы функционирования

### FU1
Стандартный режим  
Потребление тока: `3.4mA`.


### FU2 - Максимальное энергосбережение

Задержка сигнала: `400ms`  
Скорость передачи (симв.): `1,200, 2,400, 4,800`  
Потребление тока: `.08mA = 80μA`.


### FU3 - Максимальная скорость

Задержка сигнала: `< 10ms`  
Потребление тока: `23mA`.


### FU4 - Максимальное расстояние

Задержка сигнала: `>300ms`  
Скорость передачи (симв.): `9,600`  
Потребление тока: `22mA`.


## Команды

В скобках указаны переменные

### 1. `AT`  
Тестовая команда. Если всё нормально, модуль возвращает `OK`.

|Отправляем: |`AT`|
|---|---|
|Получаем:   |`OK`|


### 2. `AT+A(000-255)`  
Меняет адрес модуля в указанном диапазоне.

|Отправляем: |`AT+A012`|
|---|---|
|Получаем:   |`OK-A012`|


### 3. `AT+B(1200 | 2400 | 4800 | 9600 | 19200 | 38400 | 57600 | 115200)`  
Меняет скорость (baud rate) на одно из допустимых значений (указаны выше).

|Отправляем: |`AT+B19200`|
|---|---|
|Получаем:   |`OK-B19200`|


### 4. `AT+C(001-127)`  
Меняет канал беспроводного соединения. Нули перед числами обязательны. Если значение слишком большое, данные могут быть потеряны. Так что, на самом деле доступны каналы `001-020`.

|Отправляем: |`AT+C015`|
|---|---|
|Получаем:   |`OK-C015`|



### 5. ` AT+E(A | B | C)(соответствующие числа)`  
Эта команда используется для управления удалённым модулем. 
* Первый параметр - три выше описанные команды (адрес (A), скорость (B) и канал (C) соответственно).
* Второй - значение, которое мы хотим присвоить выбранному параметру.

  Возвращаемые значения:

    |Успех: ||
    |---|---|
    |`E(A or B or C)R` |успех|

    |Ошибки: ||
    |---|---|
    |`E(A or B or C)E`| ошибка параметра |
    |`E(A or B or C)F`| ошибка команды |
    |`Fail`| ошибка соединения |
 
    **Пример 1**:  
    Устанавливаем адрес удалённого модуля в `050`

    |Отправляем: |`AT+EA050`|
    |---|---|
    |Получаем:   |`EBR`|

    **Пример 2**:  
    Устанавливаем скорость удалённого модуля в `4800`

    |Отправляем: |`AT+EB4800`|
    |---|---|
    |Получаем:   |`EBR`|

### 6. ` AT+FC(M | S)(F | T)`  
Устанавливает модуль в режим IO управления. select M ), S (controlled).
* Первый параметр:
    * M - управляюший
    * S - управляемый    
* Второй:
    * F - повторяющий
    * T - обратный

|Один модуль отправляет: |`AT+FCMT`, чтобы стать управляющим|
|---|---|
|Другой отправляет:|`AT+FCST`, чтобы стать управляемым|

### 7. ` AT+FU(1-4)`  
Переключает в один из режимов, описанных выше.

|Отправляем: |`AT+FU1`|
|---|---|
|Получаем:   |`OK-FU1`|

### 8. `AT+GDPCxAx`  
Устаревшая команда.

  
### 9. `AT+P(1-8)`  
Устанавливает мощность передатчика

|Отправляем: |`AT+P6`|
|---|---|
|Получаем:   |`OK-P6`|

  
### 10. `AT+R(A | B | C | P)`  
Получает значение одного из параметров

|Отправляем: |`AT+RB`|
|---|---|
|Получаем:   |`B9600`|

|Отправляем: |`AT+RA`|
|---|---|
|Получаем:   |`A001`|


### 11. `AT+U(N | O | E)(1 | 2 | 3)`  
Устанавливает бит проверки данных и бит завершения последовательного порта.

    Первый параметр:
 * N - нет проверки
 * O - нечётный
 * E - чётный  

    Второй параметр:
 * 1 - стоп-бит
 * 2 - 2 бита
 * 3 - 1.5 бита

|Отправляем: |`AT+UO2`|
|---|---|
|Получаем:   |`OK-U02`|


  
### 12. `AT+RX`  
Получает значения всех параметров модуля:  
режим последовательного порта / скорость / канал / адрес / мощность 

|Отправляем: |`AT+RX`|
|---|---|
|Получаем:   |`U1 B9600 C001 A000 P8`|



### 13. `AT+V`
Получает версию прошивки.

|Отправляем: |`AT+V`|
|---|---|
|Получаем:   |`HC-11_V1.3`|


### 14. `AT+SLEEP`
Переводит модуль в спящий режим после выхода из AT. В этом режиме не возможна передача данных. Чтобы выйти из спящего режима, нужно войти в AT ещё раз. Эта команда доступна с версии `1.8`.
Потребление тока: `.02mA = 20μA`.

|Отправляем: |`AT+SLEEP`|
|---|---|
|Получаем:   |`OK`|


### 15. `AT+RESET`
Сбрасывает последовательный порт, канал и адрес в стандартные значения.

|Отправляем: |`AT+RESET`|
|---|---|
|Получаем:   |`RESET_OK`|


### 16. `AT+IV`
Получает версию внутреннего кода управления. Команда доступна с версии `1.9`

|Отправляем: |`AT+IV`|
|---|---|
|Получаем:   |`I1`|


### 17. `AT+UPDATE`
Переводит модуль в режим ожидания обновления.
После отправки команды модуль не будет отвечать на команды до перезагрузки.
После того как контроллер последовательного порта отправит команду, закройте последовательный порт, выберите файл в помощнике обновления HC-11, откройте последовательный порт. Затем модуль сможет обновиться

## Рекомендации

 1. If the distance between two modules is very close (less than 0.5m), it would be better that the
transmitting power of two modules are set to be low, e.g. P1～P3. Otherwise, receiving will be
saturated and communication between modules will fail. If the distance is only several centimeters,
communication cannot be 

1. Если расстояние между модулями слишком маленькое (меньше 50 см), стоит установить мощность передачи небольшой (P1 - P3). Иначе, передача будет перенасыщена и соединение не удастся. Если расстояние составляет несколько сантиметров, передача, вероятно, не получится.

## Режим беспроводного IO
На данный момент работа ведётся в именно в этом направлении: дистанционное управление модулем.
