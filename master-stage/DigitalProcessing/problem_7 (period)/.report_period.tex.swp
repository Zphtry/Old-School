\documentclass[12pt]{article}
\usepackage[russian]{babel}
\usepackage[utf8x]{inputenc}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{geometry}
\usepackage[colorinlistoftodos]{todonotes}
\usepackage{listings}
\usepackage[section]{placeins}
\begin{document}

\title{7. Спектральное оценивание при помощи периодограммного метода}
\author{Андрей Валиков}
\date{}
\maketitle
																																																							


\section{Формирование последовательности}


\[f = \sin(\omega_1 Tt) + \cos(\omega_2 Tt)\]


\begin{lstlisting}
N = 2 ** 11

teta = np.arange(0, N, 1)
T = .02
w1 = 81
w2 = 14
b = 5

f = np.sin(w1 * T * teta) + np.cos(w2 * T * teta)

r1 = b * np.random.rand(N)
r = r1 - np.mean(r1)

x = f + r;

plt.plot(teta, f)
plt.show()

plt.plot(teta, r)
plt.show()

plt.plot(teta, x)
plt.show()
\end{lstlisting}


\begin{figure}[!htb]
\centering
\includegraphics[scale=1.00]{good.png}
\caption{}
\label{}
\end{figure}

\begin{figure}[!htb]
\centering
\includegraphics[scale=1.00]{bad.png}
\caption{}
\label{}
\end{figure}

\begin{figure}[!htb]
\centering
\includegraphics[scale=1.00]{ugly.png}
\caption{}
\label{}
\end{figure}


\section{Разбиение последовательности на сегменты}




\begin{lstlisting}
D = .5
L = int(N / 2)
V = int((N - D * L) / (L - D * L))
print(V)

teta1 = np.arange(0, L, 1)
x1 = np.zeros((V, L))

for i in range(L):
  x1[0, i] = x[i]
  x1[1, i] = x[i + 64]
  x1[2, i] = x[i + 128]

plt.plot(teta, x)
plt.show()

plt.plot(teta1, x1[0, :])
plt.show()

plt.plot(teta1, x1[1, :])
plt.show()

plt.plot(teta1, x1[2, :])
plt.show()
\end{lstlisting}


\begin{figure}[!htb]
\centering
%\includegraphics[scale=1.00]{sig_spectral_density.png}
\caption{}
\label{}
\end{figure}

\begin{figure}[!htb]
\centering
%\includegraphics[scale=1.00]{sig_spectral_density_abs.png}
\caption{}
\label{}
\end{figure}



\section{Расчет оценки спектральной плотности по методу коррелограмм с использованием оконной функции}

\begin{lstlisting}

max_num = Search(y)

ww1 = np.pi * max_num[0] / (128 * T)
ww2 = np.pi * max_num[1] / (128 * T)

bartletta_window = np.zeros(len(r))
ht = np.arange(0, len(r), 1)

for i in range(len(ht)):
  if ht[i] >= 0 and ht[i] <= len(ht):
    bartletta_window[i] = .42 - .5 * np.cos(2 * np.pi * ht[i] / len(ht)) + .08 * np.cos(4 * np.pi * ht[i] / len(ht))

plt.plot(ht, bartletta_window)
plt.show()

y1 = np.zeros(len(w))
for n in range(len(w)):
  for m in range(len(r)):
    y1[n] += r[m] * bartletta_window[m] * np.cos(w[n] * T * m)
    y1[n] *= 2

plt.plot(w, y1)
plt.plot(w, np.abs(y1))
plt.show()

max_num = Search(y1)
ww1_1 = np.pi * max_num(0) / (128 * T)
ww2_2 = np.pi * max_num(1) / (128 * T)
\end{lstlisting}

\begin{figure}[!htb]
\centering
%\includegraphics[scale=1.00]{bartletta_window.png}
\caption{}
\label{}
\end{figure}

\begin{figure}[!htb]
\centering
%\includegraphics[scale=1.00]{sig_spectral_density_bart.png}
\caption{}
\label{}
\end{figure}

\begin{figure}[!htb]
\centering
%\includegraphics[scale=1.00]{sig_spectral_density_bart_abs.png}
\caption{}
\label{}
\end{figure}



\section{Вывод}
Изучен каррелограммный метод оценивания спектральной плотности на тестовой последовательности дискретных значений с наложенным случайным процессом. Была найдена корреляционная функция и её спектральная плотность по методу прямоугольно окна. Далее была выбрана оконная функция Барлетта и найдена уже её спектральная плотность.\\
В результате работы программы были получены следующие угловые частоты:\\
    • С использование прямоугольного окна\\
$\omega_{1}$ = 148.16\\
$\omega_{2}$ = 147.85\\
\\
    • С использование оконной функции Бартлетта\\
$\omega_{1bart}$ = 71\\
$\omega_{2bart}$ = 70.83\\

Графики спектральной плотности двух методов отличаются. Благодаря использованию оконной функции Бартлетта было убрано явление Гиббса, возникновение которого связано с использованием прямоугольного окна.

\end{document}